<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kohde-haku & Muistio</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; max-width: 800px; margin: 20px auto; padding: 0 20px; color: #333; }
        h2 { border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        .haku-alue { background: #f0f4f8; padding: 20px; border-radius: 8px; margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap; }
        input, select { padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        
        .kohde-kortti { 
            border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 10px; 
            display: flex; justify-content: space-between; align-items: center;
        }
        .kayty { background-color: #e8f5e9; border-color: #a5d6a7; }
        .nimi { font-weight: bold; font-size: 1.1em; color: #007bff; }
        .hinta { color: #28a745; font-weight: bold; }
        .tahdet { color: #f39c12; }
        
        button.nappi { cursor: pointer; padding: 8px 12px; border: none; border-radius: 4px; background: #6c757d; color: white; }
        button.nappi.aktiivinen { background: #28a745; }
    </style>
</head>
<body>

    <h2>üìç Matkakohteet & Muistio</h2>

    <div class="haku-alue">
        <input type="text" id="hakukentta" placeholder="Etsi kaupunkia tai kohdetta..." oninput="suodata()">
        <select id="hintasuodatin" onchange="suodata()">
            <option value="kaikki">Kaikki hinnat</option>
            <option value="ilmainen">Vain ilmaiset</option>
        </select>
        <span id="laskuri"></span>
    </div>

    <ul id="lista" style="list-style: none; padding: 0;"></ul>

    <script>
        let kaikkiKohteet = [];
        // Haetaan k√§ydyt kohteet selaimen muistista (LocalStorage)
        let kaytyLista = JSON.parse(localStorage.getItem('kaytyKohteet')) || [];

        fetch('kohteet.json')
            .then(res => res.json())
            .then(data => {
                kaikkiKohteet = data;
                naytaKohteet(kaikkiKohteet);
            });

        function naytaKohteet(kohteet) {
            const lista = document.getElementById('lista');
            lista.innerHTML = '';
            
            kohteet.forEach((item, index) => {
                const onKayty = kaytyLista.includes(item.nimi + item.kohde);
                const li = document.createElement('li');
                li.className = `kohde-kortti ${onKayty ? 'kayty' : ''}`;

                const hintaTeksti = item.hinta === 0 ? 'Ilmainen' : item.hinta + ' ‚Ç¨';
                const tahdetVisual = '‚òÖ'.repeat(item.t√§hdet) + '‚òÜ'.repeat(5 - item.t√§hdet);

                li.innerHTML = `
                    <div>
                        <div class="nimi">${item.nimi}: ${item.kohde}</div>
                        <div><span class="hinta">${hintaTeksti}</span> | <span class="tahdet">${tahdetVisual}</span></div>
                    </div>
                    <button class="nappi ${onKayty ? 'aktiivinen' : ''}" onclick="merkitseKaydyksi('${item.nimi + item.kohde}', this)">
                        ${onKayty ? '‚úì K√§yty' : 'Merkitse k√§ydyksi'}
                    </button>
                `;
                lista.appendChild(li);
            });
            document.getElementById('laskuri').textContent = `L√∂ytyi: ${kohteet.length} kpl`;
        }

        function suodata() {
            const hakusana = document.getElementById('hakukentta').value.toLowerCase();
            const hintaValinta = document.getElementById('hintasuodatin').value;

            const suodatetut = kaikkiKohteet.filter(item => {
                const t√§sm√§√§Haku = item.nimi.toLowerCase().includes(hakusana) || item.kohde.toLowerCase().includes(hakusana);
                const t√§sm√§√§Hinta = hintaValinta === 'kaikki' || (hintaValinta === 'ilmainen' && item.hinta === 0);
                return t√§sm√§√§Haku && t√§sm√§√§Hinta;
            });
            naytaKohteet(suodatetut);
        }

        function merkitseKaydyksi(id, nappi) {
            if (kaytyLista.includes(id)) {
                kaytyLista = kaytyLista.filter(i => i !== id); // Poista merkint√§
            } else {
                kaytyLista.push(id); // Lis√§√§ merkint√§
            }
            localStorage.setItem('kaytyKohteet', JSON.stringify(kaytyLista));
            suodata(); // P√§ivit√§ listan v√§rit
        }
    </script>
</body>
</html>
